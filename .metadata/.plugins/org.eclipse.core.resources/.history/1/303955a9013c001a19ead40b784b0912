/*
 * miniscope.h
 *
 *  Created on: Jan 20, 2020
 *      Author: DBAharoni
 */

#ifndef MINISCOPE_H_
#define MINISCOPE_H_

#include "definitions.h"
#include <cyu3types.h>

// Globals

// Holds generic I2C commands waiting to be sent
#define			I2C_PACKET_BUFFER_SIZE	64
static uint8_t 	pendingI2CPacket[I2C_PACKET_BUFFER_SIZE][6]; //circular buffer
uint8_t			I2CNumPacketsPending = 0;
uint8_t			I2CPacketNextReadIdx = 0;
uint8_t			I2CPacketNextWriteIdx = 0;

uint8_t			I2CPacketState = 0; // 0 is no no packet incoming. 5 is full packet to trigger packetsPending++
//----------------------------------
extern int I2CNumPacketsPending;

// Handles the processing and sending of generic I2C packets that have built up since previous End of Frame event
extern void I2CProcessAndSendPendingPacket (void);

#endif /* MINISCOPE_H_ */
